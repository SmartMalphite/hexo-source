---
title: MySQL基础架构
date: 2022-10-09 22:00:49
categories: 
    - MySQL学习笔记
tags: 
    - MySQL基础架构
---

## MySQL基础架构

### 1. MySQL基本架构梳理

大体来说，MySQL 可以分为 Server 层和存储引擎层两部分。

Server 层包括连接器、查询缓存、分析器、优化器、执行器等，涵盖 MySQL 的大多数核心服务功能，以及所有的内置函数（如日期、时间、数学和加密函数等），所有跨存储引擎的功能都在这一层实现，比如存储过程、触发器、视图等。

而存储引擎层负责数据的存储和提取。其架构模式是插件式的，支持 InnoDB、MyISAM、Memory 等多个存储引擎。现在最常用的存储引擎是 InnoDB，它从 MySQL 5.5.5 版本开始成为了默认存储引擎。

<img src="https://raw.githubusercontent.com/enbo-wang/new_picbed/master/img/0d2070e8f84c4801adbfa03bda1f98d9.png" alt="img" style="zoom: 33%;" />

### 2.各模块细分特性

#### 2.1 连接器

验证完用户名密码后会查询拥有的权限，之后该连接中所有的权限判断逻辑都依赖此时读到的权限(也就是说修改权限之后重新登陆才会生效)

#### 2.2 查询缓存

查询请求会优先在缓存中查找数据，之前执行过的语句与结果会以key-value的形式储存在内存中；

不建议使用，一个表上主要有更新，所有的查询缓存都会被清空，对于更新频率较高的表性价比很低，可以设置为显示指定是否使用缓存；

MySQL 8.0已整体移除；

#### 2.3 分析器

词法解析+语法解析

#### 2.4 优化器

优化器是在表里面有多个索引的时候，决定使用哪个索引；或者在一个语句有多表关联（join）的时候，决定各个表的连接顺序。

#### 2.5 执行器

鉴权并根据表的引擎定义，去使用这个引擎提供的接口。

1. 调用 InnoDB 引擎接口取这个表的第一行，判断 ID 值是不是 10，如果不是则跳过，如果是则将这行存在结果集中；
2. 调用引擎接口取“下一行”，重复相同的判断逻辑，直到取到这个表的最后一行。
3. 执行器将上述遍历过程中所有满足条件的行组成的记录集作为结果集返回给客户端。



